{% extends 'base.html' %}
{% load static %}

{% block title %}ë©˜í‹° ëŒ€ì‹œë³´ë“œ{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/mentee/mentee.css' %}">
<style>
.kanban-card.dragging {
  opacity: 0.5;
}
.success-column .kanban-card {
  text-decoration: line-through;
  color: #888;
}
.kanban-card {
  cursor: pointer;
  transition: box-shadow 0.18s, transform 0.18s;
}
.kanban-card:hover {
  box-shadow: 0 4px 16px rgba(0,0,0,0.10);
  transform: translateY(-2px) scale(1.03);
  z-index: 2;
}
</style>
{% endblock %}

{% block content %}
  <div class="main-content">
    <div class="welcome-section">
      <div class="welcome-text">ì•ˆë…•í•˜ì„¸ìš” sinipë‹˜! ì˜¤ëŠ˜ë„ ì„±ì¥ì„ ìœ„í•œ ì—¬ì •ì„ ë‹¬ë ¤ë³´ì„¸ìš”~</div>
      <div class="level-info">
        <div class="level-avatar">ğŸ°</div>
        <div class="level-details">
          <div class="level-title">level 2</div>
          <div class="level-progress">
            <div class="progress-bar"><div class="progress-fill"></div></div>
            <div class="progress-text">270 / 300 EXP</div>
          </div>
        </div>
      </div>
    </div>

    <div class="kanban-section">
      <div class="filter-section">
        <div class="filter-dropdown">
          <button class="filter-btn" onclick="toggleFilterMenu()">
            <span id="current-filter">ì „ì²´ ë³´ê¸°</span>
            <span class="filter-arrow">â–¼</span>
          </button>
          <div class="filter-menu" id="filter-menu">
            <div class="filter-option selected" onclick="selectFilter('all', 'ì „ì²´ ë³´ê¸°')">ì „ì²´ ë³´ê¸°</div>
            <div class="filter-option" onclick="selectFilter('day', 'í•˜ë£¨ ë‹¨ìœ„ë¡œ ë³´ê¸°')">í•˜ë£¨ ë‹¨ìœ„ë¡œ ë³´ê¸°</div>
            <div class="filter-option" onclick="selectFilter('week', 'ì£¼ ë‹¨ìœ„ë¡œ ë³´ê¸°')">ì£¼ ë‹¨ìœ„ë¡œ ë³´ê¸°</div>
            <div class="filter-option" onclick="selectFilter('month', 'ì›” ë‹¨ìœ„ë¡œ ë³´ê¸°')">ì›” ë‹¨ìœ„ë¡œ ë³´ê¸°</div>
          </div>
        </div>
      </div>

      <div class="kanban-board">
        <div class="kanban-column todo-column" ondrop="drop(event)" ondragover="allowDrop(event)">
          <div class="kanban-header">Todo</div>
          <div class="kanban-card" data-date="2025-07-04" draggable="true" id="task1">
            <span>ì—…ë¬´ ì¼ì§€ ì‘ì„±í•˜ê¸°</span>
            <div class="task-date">2025-07-04</div>
          </div>
          <div class="kanban-card" data-date="2025-07-05" draggable="true" id="task5">
            <span>íŒ€ íšŒì˜ ì¤€ë¹„</span>
            <div class="task-date">2025-07-05</div>
          </div>
          <div class="kanban-card" data-date="2025-07-06" draggable="true" id="task6">
            <span>ì‹ ê·œ ê¸°ëŠ¥ ì•„ì´ë””ì–´ ì •ë¦¬</span>
            <div class="task-date">2025-07-06</div>
          </div>
        </div>
        <div class="kanban-column processing-column" ondrop="drop(event)" ondragover="allowDrop(event)">
          <div class="kanban-header">Processing</div>
          <div class="kanban-card" data-date="2025-07-03" draggable="true" id="task2">
            <span>ì œí’ˆ í”„ë¡œí† íƒ€ì… ì œì‘í•˜ê¸°</span>
            <div class="task-date">2025-07-03</div>
          </div>
          <div class="kanban-card" data-date="2025-07-05" draggable="true" id="task7">
            <span>ì½”ë“œ ë¦¬ë·° ì°¸ì—¬</span>
            <div class="task-date">2025-07-05</div>
          </div>
        </div>
        <div class="kanban-column success-column" ondrop="drop(event)" ondragover="allowDrop(event)">
          <div class="kanban-header">Success</div>
          <div class="kanban-card" data-date="2025-07-02" draggable="true" id="task4">
            <span>ì†”ë£¨ì…˜ ìê¸°ì†Œê°œ ì…ë ¥í•˜ê¸°</span>
            <div class="task-date">2025-07-02</div>
          </div>
          <div class="kanban-card" data-date="2025-07-01" draggable="true" id="task8">
            <span>ë©˜í† ì™€ 1:1 ë¯¸íŒ…</span>
            <div class="task-date">2025-07-01</div>
          </div>
          <div class="kanban-card" data-date="2025-06-30" draggable="true" id="task9">
            <span>ì˜¤ë¦¬ì—”í…Œì´ì…˜ ì°¸ì„</span>
            <div class="task-date">2025-06-30</div>
          </div>
        </div>
      </div>
    </div>

    <div class="activity-section">
      <div class="activity-header">ìµœê·¼í™œë™</div>
      <div class="activity-item">
        <div>ì½”ë“œ ë¦¬ë·° ì°¸ì—¬ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤</div>
        <div>1 minute ago</div>
      </div>
      <div class="activity-item">
        <div>ì œí’ˆ í”„ë¡œí† íƒ€ì… ì œì‘ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤</div>
        <div>10 minute ago</div>
      </div>
      <div class="activity-item">
        <div>ì†”ë£¨ì…˜ ìê¸°ì†Œê°œ ì…ë ¥ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</div>
        <div>1 day ago</div>
      </div>
      <div class="activity-item">
        <div>ë©˜í† ì™€ 1:1 ë¯¸íŒ… ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</div>
        <div>2 day ago</div>
      </div>
      <div class="activity-item">
        <div>ì˜¤ë¦¬ì—”í…Œì´ì…˜ ì°¸ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤</div>
        <div>3 day ago</div>
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/mentee/mentee.js' %}"></script>
<script>
function allowDrop(ev) {
  ev.preventDefault();
}
let dragged = null;
document.querySelectorAll('.kanban-card').forEach(card => {
  card.addEventListener('dragstart', function(e) {
    dragged = card;
    setTimeout(() => card.classList.add('dragging'), 0);
  });
  card.addEventListener('dragend', function(e) {
    card.classList.remove('dragging');
    dragged = null;
  });
});
function drop(ev) {
  ev.preventDefault();
  if (dragged) {
    const col = ev.currentTarget;
    col.appendChild(dragged);
    // Success ì»¬ëŸ¼ì— ë“¤ì–´ê°€ë©´ ì·¨ì†Œì„ , ì•„ë‹ˆë©´ ì·¨ì†Œì„  ì œê±°
    if (col.classList.contains('success-column')) {
      dragged.classList.add('success-task');
    } else {
      dragged.classList.remove('success-task');
    }
  }
}
// Success ì»¬ëŸ¼ì— ìˆëŠ” ì¹´ë“œì— ì·¨ì†Œì„  ì ìš©
function updateSuccessLine() {
  document.querySelectorAll('.success-column .kanban-card').forEach(card => {
    card.classList.add('success-task');
  });
  document.querySelectorAll('.kanban-column:not(.success-column) .kanban-card').forEach(card => {
    card.classList.remove('success-task');
  });
}
document.querySelectorAll('.kanban-card').forEach(card => {
  card.addEventListener('dragend', updateSuccessLine);
});
window.addEventListener('DOMContentLoaded', updateSuccessLine);
</script>
{% endblock %}