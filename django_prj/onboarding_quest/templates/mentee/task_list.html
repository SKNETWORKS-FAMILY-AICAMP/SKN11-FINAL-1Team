{% extends 'base.html' %}
{% load static %}

{% block title %}íƒœìŠ¤í¬ ëª©ë¡ í˜ì´ì§€{% endblock %}
{% block extra_head %}
<style>
.tasklist-container {
  display: flex;
  gap: 32px;
  width: 100%;
  min-height: 600px;
}
.tasklist-left {
  flex: 1;
  padding: 24px 0 24px 24px;
  background: #fafbfc;
  border-radius: 12px 0 0 12px;
  min-width: 340px;
  max-width: 500px;
  overflow-y: auto;
}
.tasklist-title {
  font-size: 1.3em;
  font-weight: bold;
  margin-bottom: 18px;
  color: #222;
}
.tasklist-search-row {
  display: flex;
  gap: 8px;
  margin-bottom: 24px;
}
.tasklist-search {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 15px;
}
.tasklist-create-btn {
  padding: 8px 18px;
  background: #ffd600;
  color: #222;
  border: none;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
}
.task-card {
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  margin-bottom: 18px;
  padding: 18px 20px 14px 20px;
  border-left: 6px solid #ffd600;
  transition: box-shadow 0.2s, border-color 0.2s;
  cursor: pointer;
  position: relative;
}
.task-card.in-progress { border-left-color: #4caf50; }
.task-card.done { border-left-color: #ffd600; background: #f6fff6; }
.task-card.selected { box-shadow: 0 0 0 3px #1976d233; border-left-color: #1976d2; }
.task-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 17px;
  font-weight: bold;
  margin-bottom: 6px;
}
.task-title { color: #222; }
.task-xp { color: #888; font-size: 15px; display: flex; align-items: center; gap: 4px; }
.icon-trophy { width: 18px; height: 18px; vertical-align: middle; }
.task-desc { color: #555; font-size: 14px; margin-bottom: 8px; }
.task-meta-row {
  display: flex;
  gap: 10px;
  align-items: center;
  font-size: 13px;
}
.task-week { color: #666; }
.task-badge {
  padding: 2px 10px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  display: inline-block;
}
.task-badge.green { background: #4caf50; }
.task-badge.yellow { background: #ffd600; color: #222; }

.subtask-toggle {
  display: flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  margin: 0 0 0 6px;
  font-size: 18px;
  color: #222;
  user-select: none;
}
.subtask-list {
  margin: 0 0 0 32px;
  padding: 0;
  border: 1px solid #bbb;
  border-radius: 8px;
  background: #fff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  margin-bottom: 10px;
  display: none;
}
.subtask-list.open { display: block; }
.subtask-card {
  padding: 12px 16px 10px 16px;
  border-bottom: 1px solid #eee;
  font-size: 15px;
  cursor: pointer;
}
.subtask-card:last-child { border-bottom: none; }
.subtask-title { font-weight: bold; font-size: 15px; margin-bottom: 2px; display: block; }
.subtask-desc { color: #555; font-size: 13px; margin-bottom: 4px; }
.subtask-meta-row {
  display: flex;
  gap: 8px;
  align-items: center;
  font-size: 12px;
}
.subtask-week { color: #666; }
.subtask-badge {
  padding: 2px 8px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: bold;
  color: #fff;
  display: inline-block;
}
.subtask-badge.green { background: #4caf50; }
.subtask-badge.yellow { background: #ffd600; color: #222; }

.tasklist-right {
  flex: 2;
  background: #fff;
  border-radius: 0 16px 16px 0;
  padding: 36px 48px 32px 48px;
  min-width: 600px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 10;
}
.task-detail-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  font-size: 26px;
  font-weight: bold;
  margin-bottom: 8px;
}
.task-detail-title { color: #222; font-size: 26px; font-weight: bold; }
.task-detail-xp { color: #888; font-size: 18px; display: flex; align-items: center; gap: 4px; font-weight: bold; }
.task-detail-desc { color: #222; font-size: 17px; margin-bottom: 12px; margin-top: 8px; }
.task-detail-meta-row {
  display: flex;
  gap: 10px;
  align-items: center;
  font-size: 15px;
  margin-bottom: 12px;
}
.task-detail-status {
  color: #fff;
  background: #4caf50;
  display: inline-block;
  padding: 6px 32px;
  border-radius: 12px;
  font-size: 17px;
  font-weight: bold;
  margin-bottom: 18px;
}
.task-detail-list ul {
  margin: 0 0 24px 0;
  padding-left: 0;
  color: #222;
  font-size: 17px;
  list-style: none;
}
.task-detail-list ul li {
  margin-bottom: 6px;
  font-weight: 500;
}
.task-detail-chat {
  margin-top: auto;
  background: #fafafa;
  border-radius: 12px;
  padding: 24px 24px 18px 24px;
  margin-top: 32px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.03);
}
.chat-message {
  margin-bottom: 14px;
  font-size: 15px;
  display: flex;
  flex-direction: column;
}
.chat-message .chat-user {
  font-weight: bold;
  color: #43a047;
  margin-bottom: 2px;
}
.chat-message.mine .chat-user { color: #1976d2; }
.chat-message .chat-text { color: #222; margin-bottom: 2px; }
.chat-message .chat-time { color: #aaa; font-size: 12px; }
.chat-input-row {
  display: flex;
  gap: 8px;
  margin-top: 18px;
}
.chat-input {
  flex: 1;
  padding: 12px 16px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 16px;
  background: #fff;
}
.chat-send-btn {
  padding: 0 24px;
  background: #ffd600;
  color: #222;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>
{% endblock %}
{% block content %}
<div class="tasklist-container">
  <!-- ì¢Œì¸¡: í€˜ìŠ¤íŠ¸ ëª©ë¡ -->
  <div class="tasklist-left" id="tasklist-left">
    <div class="tasklist-title">í€˜ìŠ¤íŠ¸ ëª©ë¡</div>
    <div class="tasklist-search-row">
      <input type="text" class="tasklist-search" placeholder="í€˜ìŠ¤íŠ¸ ê²€ìƒ‰...">
      <button class="tasklist-create-btn">ìƒì„±</button>
    </div>
    <div class="task-card in-progress selected" data-detail="0">
      <div class="task-card-header">
        <span class="task-title">íšŒì‚¬ ì†Œê°œ ë° ì¡°ì§ë„ ì´í•´í•˜ê¸°</span>
        <span class="task-xp"><img src="/static/img/trophy.svg" class="icon-trophy"> 50 XP</span>
      </div>
      <div class="task-desc">íšŒì‚¬ì˜ ë¹„ì „, ë¯¸ì…˜, ì¡°ì§ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ê³  íŒ€ì›ë“¤ê³¼ ì¸ì‚¬í•˜ê¸°</div>
      <div class="task-meta-row">
        <span class="task-week">1ê°œì›”ì°¨ 1ì£¼ì°¨</span>
        <span class="task-badge green">ì´ˆê¸‰</span>
      </div>
      <div class="subtask-toggle" data-toggle="0">â–¼</div>
      <div class="subtask-list" id="subtask-list-0">
        <div class="subtask-card" data-detail="0-0">
          <span class="subtask-title">ì—…ë¬´ í™˜ê²½ ì„¤ì • ë° ë„êµ¬ ìµíˆê¸°</span>
          <span class="subtask-desc">ê°œë°œ í™˜ê²½, íˆ´ ì„¤ì¹˜, ì‚¬ë‚´ ì‹œìŠ¤í…œ ì ‘ê·¼ ì•ˆë‚´</span>
          <div class="subtask-meta-row">
            <span class="subtask-week">1ê°œì›”ì°¨ 2ì£¼ì°¨</span>
            <span class="subtask-badge yellow">ì´ˆê¸‰</span>
          </div>
        </div>
        <!-- ì—¬ëŸ¬ ê°œì˜ í•˜ìœ„ íƒœìŠ¤í¬ ì˜ˆì‹œ -->
        <div class="subtask-card" data-detail="0-1">
          <span class="subtask-title">ì½”ë“œ ì»¨ë²¤ì…˜ ìˆ™ì§€</span>
          <span class="subtask-desc">íŒ€ ë‚´ ì½”ë“œ ìŠ¤íƒ€ì¼, ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ ì•ˆë‚´</span>
          <div class="subtask-meta-row">
            <span class="subtask-week">1ê°œì›”ì°¨ 2ì£¼ì°¨</span>
            <span class="subtask-badge green">ì´ˆê¸‰</span>
          </div>
        </div>
      </div>
    </div>
    <div class="task-card done" data-detail="1">
      <div class="task-card-header">
        <span class="task-title">ì²« ë²ˆì§¸ í”„ë¡œì íŠ¸ ì°¸ì—¬í•˜ê¸°</span>
        <span class="task-xp"><img src="/static/img/trophy.svg" class="icon-trophy"> 100 XP</span>
      </div>
      <div class="task-desc">ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ì— ì°¸ì—¬í•˜ì—¬ ì›Œí¬í”Œë¡œìš° ì´í•´í•˜ê¸°</div>
      <div class="task-meta-row">
        <span class="task-week">1ê°œì›”ì°¨ 3ì£¼ì°¨</span>
        <span class="task-badge yellow">ì¤‘ê¸‰</span>
      </div>
      <div class="subtask-toggle" data-toggle="1">â–¼</div>
      <div class="subtask-list" id="subtask-list-1">
        <div class="subtask-card" data-detail="1-0">
          <span class="subtask-title">í”„ë¡œì íŠ¸ í™˜ê²½ ì„¸íŒ…</span>
          <span class="subtask-desc">í”„ë¡œì íŠ¸ ì €ì¥ì†Œ í´ë¡ , ì˜ì¡´ì„± ì„¤ì¹˜</span>
          <div class="subtask-meta-row">
            <span class="subtask-week">1ê°œì›”ì°¨ 3ì£¼ì°¨</span>
            <span class="subtask-badge yellow">ì¤‘ê¸‰</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- ìš°ì¸¡: ìƒì„¸ ì •ë³´ -->
  <div class="tasklist-right">
    <div class="task-detail-header">
      <span class="task-detail-title" id="detail-title">ì²« ë²ˆì§¸ í”„ë¡œì íŠ¸ ì°¸ì—¬í•˜ê¸°</span>
      <span class="task-detail-xp"><img src="/static/img/trophy.svg" class="icon-trophy"> <span id="detail-xp">100 XP</span></span>
    </div>
    <div class="task-detail-desc" id="detail-desc">ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ì— ì°¸ì—¬í•˜ì—¬ ì›Œí¬í”Œë¡œìš° ì´í•´í•˜ê¸°</div>
    <div class="task-detail-meta-row">
      <span class="task-week" id="detail-week">1ê°œì›”ì°¨ 3ì£¼ì°¨</span>
      <span class="task-badge yellow" id="detail-badge">ì¤‘ê¸‰</span>
    </div>
    <div class="task-detail-status" id="detail-status">ì™„ë£Œë¨</div>
    <div class="task-detail-list" id="detail-list">
      <ul>
        <li>í”„ë¡œì íŠ¸ ì¤€ë¹„</li>
        <li>ì²« í”„ë¡œì íŠ¸ ì§„í–‰</li>
        <li>í”„ë¡œì íŠ¸ ê²°ê³¼ ê³µìœ </li>
      </ul>
    </div>
    <div class="task-detail-chat">
      <div class="chat-message other">
        <span class="chat-user">ì±„íŒ…ë´‡</span>
        <span class="chat-text">ê²Œì‹œê¸€ì€ 4ì£¼ì°¨ê¹Œì§€ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ê³„ì† í™•ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</span>
        <span class="chat-time">2025.06.25. 01:41</span>
      </div>
      <div class="chat-message mine">
        <span class="chat-user">ë©˜í† ìœ í˜•</span>
        <span class="chat-text">ì™„ë£Œí•˜ì˜€ìœ¼ë©°, ë‹¤ìŒê³¼ì œë„ ê¸°ëŒ€í•˜ê² ìŠµë‹ˆë‹¤.</span>
        <span class="chat-time">2025.06.25. 01:45</span>
      </div>
      <div class="chat-input-row">
        <input type="text" class="chat-input" placeholder="ë©”ì‹œì§€ ì…ë ¥...">
        <button class="chat-send-btn"><span style="font-size:20px;">ğŸ’¬</span></button>
      </div>
    </div>
  </div>
</div>
<script>
// ì¹´ë“œë³„ ìƒì„¸ ë°ì´í„° ìƒ˜í”Œ
const details = [
  {
    title: 'íšŒì‚¬ ì†Œê°œ ë° ì¡°ì§ë„ ì´í•´í•˜ê¸°',
    xp: '50 XP',
    desc: 'íšŒì‚¬ì˜ ë¹„ì „, ë¯¸ì…˜, ì¡°ì§ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ê³  íŒ€ì›ë“¤ê³¼ ì¸ì‚¬í•˜ê¸°',
    week: '1ê°œì›”ì°¨ 1ì£¼ì°¨',
    badge: { text: 'ì´ˆê¸‰', color: 'green' },
    status: 'ì§„í–‰ì¤‘',
    list: ['íšŒì‚¬ ì†Œê°œ ì˜ìƒ ì‹œì²­', 'ì¡°ì§ë„ ì—´ëŒ', 'íŒ€ì› ì¸ì‚¬'],
    subtasks: [
      {
        title: 'ì—…ë¬´ í™˜ê²½ ì„¤ì • ë° ë„êµ¬ ìµíˆê¸°',
        desc: 'ê°œë°œ í™˜ê²½, íˆ´ ì„¤ì¹˜, ì‚¬ë‚´ ì‹œìŠ¤í…œ ì ‘ê·¼ ì•ˆë‚´',
        week: '1ê°œì›”ì°¨ 2ì£¼ì°¨',
        badge: { text: 'ì´ˆê¸‰', color: 'yellow' },
        status: 'ì§„í–‰ì¤‘',
        list: ['ê°œë°œ í™˜ê²½ ì„¤ì¹˜', 'ì‚¬ë‚´ ì‹œìŠ¤í…œ ê³„ì • ë°œê¸‰'],
      },
      {
        title: 'ì½”ë“œ ì»¨ë²¤ì…˜ ìˆ™ì§€',
        desc: 'íŒ€ ë‚´ ì½”ë“œ ìŠ¤íƒ€ì¼, ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ ì•ˆë‚´',
        week: '1ê°œì›”ì°¨ 2ì£¼ì°¨',
        badge: { text: 'ì´ˆê¸‰', color: 'green' },
        status: 'ì§„í–‰ì¤‘',
        list: ['ì½”ë”© ê·œì¹™ ë¬¸ì„œ ì½ê¸°', 'ë¦¬ë·° ì˜ˆì‹œ í™•ì¸'],
      },
    ],
  },
  {
    title: 'ì²« ë²ˆì§¸ í”„ë¡œì íŠ¸ ì°¸ì—¬í•˜ê¸°',
    xp: '100 XP',
    desc: 'ê°„ë‹¨í•œ í”„ë¡œì íŠ¸ì— ì°¸ì—¬í•˜ì—¬ ì›Œí¬í”Œë¡œìš° ì´í•´í•˜ê¸°',
    week: '1ê°œì›”ì°¨ 3ì£¼ì°¨',
    badge: { text: 'ì¤‘ê¸‰', color: 'yellow' },
    status: 'ì™„ë£Œë¨',
    list: ['í”„ë¡œì íŠ¸ ì¤€ë¹„', 'ì²« í”„ë¡œì íŠ¸ ì§„í–‰', 'í”„ë¡œì íŠ¸ ê²°ê³¼ ê³µìœ '],
    subtasks: [
      {
        title: 'í”„ë¡œì íŠ¸ í™˜ê²½ ì„¸íŒ…',
        desc: 'í”„ë¡œì íŠ¸ ì €ì¥ì†Œ í´ë¡ , ì˜ì¡´ì„± ì„¤ì¹˜',
        week: '1ê°œì›”ì°¨ 3ì£¼ì°¨',
        badge: { text: 'ì¤‘ê¸‰', color: 'yellow' },
        status: 'ì§„í–‰ì¤‘',
        list: ['ì €ì¥ì†Œ í´ë¡ ', 'íŒ¨í‚¤ì§€ ì„¤ì¹˜'],
      },
    ],
  },
];

// ìƒì„¸ ì •ë³´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateDetail(idx, subIdx = null) {
  let d = details[idx];
  if (subIdx !== null && d.subtasks && d.subtasks[subIdx]) {
    d = d.subtasks[subIdx];
  }
  document.getElementById('detail-title').textContent = d.title;
  document.getElementById('detail-xp').textContent = d.xp || '';
  document.getElementById('detail-desc').textContent = d.desc;
  document.getElementById('detail-week').textContent = d.week;
  document.getElementById('detail-badge').textContent = d.badge.text;
  document.getElementById('detail-badge').className = 'task-badge ' + d.badge.color;
  document.getElementById('detail-status').textContent = d.status || '';
  // ë¦¬ìŠ¤íŠ¸
  const ul = document.createElement('ul');
  (d.list || []).forEach(item => {
    const li = document.createElement('li');
    li.textContent = item;
    ul.appendChild(li);
  });
  const listDiv = document.getElementById('detail-list');
  listDiv.innerHTML = '';
  listDiv.appendChild(ul);
}
// ì¹´ë“œ í´ë¦­
const cards = document.querySelectorAll('.task-card');
cards.forEach((card, idx) => {
  card.addEventListener('click', function() {
    cards.forEach(c => c.classList.remove('selected'));
    card.classList.add('selected');
    updateDetail(idx);
  });
});
// í•˜ìœ„ íƒœìŠ¤í¬ í† ê¸€
const toggles = document.querySelectorAll('.subtask-toggle');
toggles.forEach(toggle => {
  toggle.addEventListener('click', function(e) {
    e.stopPropagation();
    const idx = toggle.getAttribute('data-toggle');
    const list = document.getElementById('subtask-list-' + idx);
    if (list.classList.contains('open')) {
      list.classList.remove('open');
      toggle.textContent = 'â–¼';
    } else {
      list.classList.add('open');
      toggle.textContent = 'â–²';
    }
  });
});
// í•˜ìœ„ íƒœìŠ¤í¬ í´ë¦­ ì‹œ ìƒì„¸ í‘œì‹œ
const subtaskCards = document.querySelectorAll('.subtask-card');
subtaskCards.forEach(card => {
  card.addEventListener('click', function(e) {
    e.stopPropagation();
    const [parentIdx, subIdx] = card.getAttribute('data-detail').split('-').map(Number);
    // ìƒìœ„ ì¹´ë“œ ì„ íƒ í‘œì‹œ
    cards.forEach(c => c.classList.remove('selected'));
    cards[parentIdx].classList.add('selected');
    updateDetail(parentIdx, subIdx);
  });
});
// ìµœì´ˆ ë¡œë”© ì‹œ ì²« ë²ˆì§¸ ì¹´ë“œ ìƒì„¸ í‘œì‹œ
updateDetail(0);
</script>
{% endblock %}
