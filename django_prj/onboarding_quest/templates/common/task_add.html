<input type="hidden" name="status" id="status-input" value="진행 전" required>{% extends 'base.html' %}
{% load static %}

{% block title %}Task 생성 페이지{% endblock %}
{% block extra_head %}
<style>
.taskadd-container {
  display: flex;
  gap: 32px;
  width: 100%;
  min-height: 700px;
  max-width: 1400px;
  margin: 0 auto;
}

.taskadd-left {
  flex: 0 0 450px;
  padding: 32px;
  background: #f8f9fa;
  border-radius: 12px;
  border: 1px solid #e9ecef;
}

.taskadd-title {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 24px;
  color: #212529;
}

.taskadd-desc {
  background: #ffffff;
  border-radius: 8px;
  border: 1px solid #dee2e6;
  padding: 24px;
  margin-bottom: 24px;
  color: #495057;
  font-size: 16px;
  line-height: 1.6;
}

.taskadd-guide {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 8px;
  padding: 20px 24px;
  font-size: 15px;
  color: #856404;
  margin-bottom: 24px;
}

.taskadd-right {
  flex: 1;
  background: #ffffff;
  border-radius: 12px;
  border: 1px solid #e9ecef;
  padding: 32px 40px 40px 40px;
  min-width: 600px;
}

.task-header {
  font-size: 28px;
  font-weight: 600;
  color: #212529;
  margin-bottom: 40px;
  padding-bottom: 16px;
  border-bottom: 2px solid #f8f9fa;
}

.form-group {
  margin-bottom: 32px;
}

.form-group.row-flex {
  display: flex;
  align-items: center;
  gap: 20px;
}

.form-label {
  display: block;
  font-size: 18px;
  font-weight: 600;
  color: #495057;
  margin-bottom: 12px;
}

.form-label.inline-label {
  margin-bottom: 0;
  min-width: 100px;
}

.status-btn-group, .level-btn-group {
  display: flex;
  gap: 12px;
}

.status-btn, .level-btn {
  border: 1px solid #dee2e6;
  border-radius: 8px;
  background: #ffffff;
  color: #495057;
  font-weight: 500;
  font-size: 16px;
  padding: 12px 24px;
  min-width: 80px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
  outline: none;
}

.status-btn:hover, .level-btn:hover {
  background: #f8f9fa;
  border-color: #adb5bd;
}

.status-btn.selected {
  background: #007bff;
  border-color: #007bff;
  color: #ffffff;
}

.level-btn.level-high {
  border-color: #dc3545;
  color: #dc3545;
}

.level-btn.level-high.selected, .level-btn.level-high:hover {
  background: #dc3545;
  color: #ffffff;
}

.level-btn.level-mid {
  border-color: #ffc107;
  color: #ffc107;
}

.level-btn.level-mid.selected, .level-btn.level-mid:hover {
  background: #ffc107;
  color: #212529;
}

.level-btn.level-low {
  border-color: #28a745;
  color: #28a745;
}

.level-btn.level-low.selected, .level-btn.level-low:hover {
  background: #28a745;
  color: #ffffff;
}

.form-textarea {
  width: 100%;
  border: 1px solid #ced4da;
  border-radius: 8px;
  padding: 16px;
  font-size: 16px;
  font-family: inherit;
  background: #ffffff;
  color: #495057;
  outline: none;
  transition: border-color 0.2s ease;
  resize: vertical;
}

.form-textarea:focus {
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

#title.form-textarea {
  min-height: 60px;
  max-height: 80px;
  font-weight: 500;
  resize: none;
}

#detail.form-textarea {
  min-height: 150px;
  max-height: 250px;
  line-height: 1.5;
}

.form-input {
  border: 1px solid #ced4da;
  border-radius: 8px;
  padding: 12px 16px;
  font-size: 16px;
  background: #ffffff;
  color: #495057;
  outline: none;
  transition: border-color 0.2s ease;
}

.form-input:focus {
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

.form-input[type="date"] {
  width: 180px;
}

.form-row-2col {
  display: flex;
  gap: 40px;
  margin-bottom: 32px;
}

.form-group.col-2line {
  flex: 1;
  margin-bottom: 0;
}

.form-actions {
  margin-top: 48px;
  display: flex;
  gap: 16px;
  justify-content: flex-end;
  padding-top: 32px;
  border-top: 1px solid #e9ecef;
}

.submit-btn {
  background: #007bff;
  color: #ffffff;
  font-weight: 500;
  border: none;
  border-radius: 8px;
  padding: 16px 32px;
  font-size: 16px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.submit-btn:hover {
  background: #0056b3;
}

.cancel-btn {
  background: #6c757d;
  color: #ffffff;
  font-weight: 500;
  border: none;
  border-radius: 8px;
  padding: 16px 32px;
  font-size: 16px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.cancel-btn:hover {
  background: #545b62;
}

.required-mark {
  color: #dc3545;
  margin-left: 4px;
}

/* 반응형 */
@media (max-width: 768px) {
  .taskadd-container {
    flex-direction: column;
    gap: 20px;
  }
  
  .taskadd-left {
    flex: none;
    padding: 24px;
  }
  
  .taskadd-right {
    min-width: auto;
    padding: 24px;
  }
  
  .form-row-2col {
    flex-direction: column;
    gap: 20px;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="taskadd-container">
  <div class="taskadd-left">
    <div class="taskadd-title">Task 작성 가이드</div>
    <div class="taskadd-desc">
      • Task 제목과 상세 내용을 구체적으로 작성해 주세요<br>
      • 난이도에 따라 업무 분류가 자동으로 설정됩니다<br>
      • 마감일자를 정확히 입력하여 일정 관리에 활용하세요
    </div>
    <div class="taskadd-guide">
      ※ Task는 프로젝트, 업무, 학습 등 다양한 목적으로 활용 가능합니다
    </div>
  </div>
  
  <div class="taskadd-right">
    <form method="post" class="task-form">
      {% csrf_token %}
      
      <div class="form-group">
        <label class="form-label" for="title">제목 <span class="required-mark">*</span></label>
        <textarea name="title" id="title" placeholder="Task 제목을 입력하세요" required class="form-textarea"></textarea>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="detail">상세 내용 <span class="required-mark">*</span></label>
        <textarea name="detail" id="detail" placeholder="Task의 상세 내용을 입력하세요" required class="form-textarea"></textarea>
      </div>
      
      <div class="form-row-2col">
        <div class="form-group col-2line">
          <label class="form-label inline-label">난이도 <span class="required-mark">*</span></label>
          <div class="level-btn-group">
            <button type="button" class="level-btn level-high" data-level="상">상</button>
            <button type="button" class="level-btn level-mid" data-level="중">중</button>
            <button type="button" class="level-btn level-low" data-level="하">하</button>
            <input type="hidden" name="level" id="level-input" required>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label" for="deadline">마감일자 <span class="required-mark">*</span></label>
        <input type="date" name="deadline" id="deadline" class="form-input" required>
      </div>
      
      <div class="form-actions">
        <button type="button" class="cancel-btn" onclick="history.back()">취소</button>
        <button type="submit" class="submit-btn" onclick="history.back()">생성</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/task_add.js' %}"></script>
<script>
// 상태 버튼 선택 효과
const statusBtns = document.querySelectorAll('.status-btn');
const statusInput = document.getElementById('status-input');
statusBtns.forEach(btn => {
  btn.addEventListener('click', function() {
    statusBtns.forEach(b => b.classList.remove('selected'));
    this.classList.add('selected');
    statusInput.value = this.dataset.status;
  });
});

// 난이도 버튼 선택 효과
const levelBtns = document.querySelectorAll('.level-btn');
const levelInput = document.getElementById('level-input');
levelBtns.forEach(btn => {
  btn.addEventListener('click', function() {
    levelBtns.forEach(b => b.classList.remove('selected'));
    this.classList.add('selected');
    levelInput.value = this.dataset.level;
  });
});

// 오늘 날짜 이후만 선택 가능하도록 설정
const deadlineInput = document.getElementById('deadline');
const today = new Date().toISOString().split('T')[0];
deadlineInput.min = today;

// 폼 제출 시 유효성 검사
document.querySelector('.task-form').addEventListener('submit', function(e) {
  if (!levelInput.value) {
    e.preventDefault();
    alert('난이도를 선택해주세요.');
    return;
  }
  
  if (!deadlineInput.value) {
    e.preventDefault();
    alert('마감일자를 입력해주세요.');
    return;
  }
});
</script>
{% endblock %}