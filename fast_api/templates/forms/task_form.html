{% extends "base.html" %}

{% block title %}태스크 관리 - 온보딩 퀘스트 시스템{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">태스크 관리</h1>
        <p class="text-gray-600">학습 태스크를 생성하고 관리합니다.</p>
    </div>

    <!-- 성공 메시지 -->
    {% if request.query_params.get('success') %}
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
        <strong>성공!</strong> 태스크가 성공적으로 생성되었습니다.
    </div>
    {% endif %}

    <!-- 에러 메시지 -->
    {% if error %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
        <strong>오류:</strong> {{ error }}
    </div>
    {% endif %}

    <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
        <!-- 태스크 생성 폼 -->
        <div class="xl:col-span-2 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold text-gray-900 mb-4">새 태스크 생성</h2>
            <form method="POST" action="/forms/tasks" class="space-y-4">
                <div>
                    <label for="title" class="block text-sm font-medium text-gray-700 mb-2">태스크 제목</label>
                    <input type="text" 
                           id="title" 
                           name="title" 
                           required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                           placeholder="태스크 제목을 입력하세요">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="start_date" class="block text-sm font-medium text-gray-700 mb-2">시작일</label>
                        <input type="date" 
                               id="start_date" 
                               name="start_date" 
                               required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label for="end_date" class="block text-sm font-medium text-gray-700 mb-2">종료일</label>
                        <input type="date" 
                               id="end_date" 
                               name="end_date" 
                               required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
                    </div>
                </div>
                
                <div>
                    <label for="description" class="block text-sm font-medium text-gray-700 mb-2">태스크 설명</label>
                    <textarea id="description" 
                              name="description" 
                              rows="4"
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent"
                              placeholder="태스크에 대한 설명을 입력하세요"></textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label for="difficulty" class="block text-sm font-medium text-gray-700 mb-2">난이도</label>
                        <select id="difficulty" 
                                name="difficulty" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
                            <option value="">난이도를 선택하세요</option>
                            <option value="쉬움">쉬움</option>
                            <option value="보통">보통</option>
                            <option value="어려움">어려움</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="exp" class="block text-sm font-medium text-gray-700 mb-2">경험치</label>
                        <input type="number" 
                               id="exp" 
                               name="exp" 
                               min="1"
                               value="100"
                               required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label for="order" class="block text-sm font-medium text-gray-700 mb-2">순서</label>
                        <input type="number" 
                               id="order" 
                               name="order" 
                               min="1"
                               value="1"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
                    </div>
                </div>
                
                <div>
                    <label for="template_id" class="block text-sm font-medium text-gray-700 mb-2">소속 템플릿</label>
                    <select id="template_id" 
                            name="template_id" 
                            required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
                        <option value="">템플릿을 선택하세요</option>
                        {% for template in templates_list %}
                        <option value="{{ template.template_id }}">{{ template.template_title }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="flex gap-4">
                    <button type="submit" 
                            class="flex-1 bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 transition-colors">
                        태스크 생성
                    </button>
                    <button type="reset" 
                            class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors">
                        초기화
                    </button>
                </div>
            </form>
        </div>

        <!-- 태스크 목록 -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold text-gray-900 mb-4">등록된 태스크</h2>
            <div class="space-y-3 max-h-96 overflow-y-auto">
                {% if tasks %}
                    {% for task in tasks %}
                    <div class="p-3 bg-gray-50 rounded-md">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold text-gray-900">{{ task.title }}</h3>
                                <p class="text-sm text-gray-600">{{ task.start_date }} ~ {{ task.end_date }}</p>
                                {% if task.description %}
                                <p class="text-sm text-gray-500 mt-1">{{ task.description }}</p>
                                {% endif %}
                                <div class="flex gap-2 mt-2">
                                    {% if task.difficulty %}
                                    <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded">{{ task.difficulty }}</span>
                                    {% endif %}
                                    <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded">{{ task.exp }}XP</span>
                                    <span class="text-xs px-2 py-1 bg-purple-100 text-purple-800 rounded">순서: {{ task.order }}</span>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button class="text-blue-500 hover:text-blue-700 text-sm">수정</button>
                                <button class="text-red-500 hover:text-red-700 text-sm">삭제</button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center py-8">
                        <div class="text-gray-400 text-6xl mb-4">📋</div>
                        <p class="text-gray-500">등록된 태스크가 없습니다.</p>
                        <p class="text-sm text-gray-400">좌측 폼을 통해 새 태스크를 생성하세요.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- 안내 정보 -->
    <div class="mt-8 bg-red-50 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-red-900 mb-2">📝 사용법</h3>
        <div class="text-red-700 space-y-2">
            <p>• 태스크 제목과 기간을 설정하고 "태스크 생성" 버튼을 클릭하세요.</p>
            <p>• 난이도: 쉬움/보통/어려움 중 선택 (학습자의 수준에 맞게 설정)</p>
            <p>• 경험치: 태스크 완료 시 획득할 경험치 (1~1000점)</p>
            <p>• 순서: 태스크 진행 순서 (1부터 시작)</p>
            <p>• 템플릿이 먼저 생성되어 있어야 합니다.</p>
        </div>
    </div>
</div>
{% endblock %} 